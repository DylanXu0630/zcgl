<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>房屋租赁合同</title>
    <style>
        html {
            -webkit-text-size-adjust: none;
        }

        span {
            padding: 0 15px;
        }
        #htall{
            width: 750px;
        }
    </style>
</head>
<body>
<link rel="stylesheet" href="css/ht.css">
<div id="htall" style="font-size: 20px !important;">
    <div class="titleBt">蠡园开发区房屋出租审核表（一事一议）</div>
    <div class="thbh">合同编号：<span class="pageSpan s-bbh"></span></div>
    <table class="pageTable" border="1" cellspacing="0" style="height: 1000px">
        <tr>
            <td style="padding:0 10px;">管理中心（或经营托管单位)</td>
            <td colspan="5" style="padding:0 10px;"><span class="glzx"></span></td>
        </tr>
        <tr>
            <td style="padding:0 10px;">房屋产权单位</td>
            <td colspan="5" style="padding:0 10px;"><span class="jf"></span></td>
        </tr>
        <tr>
            <td style="padding:0 10px;">房产坐落</td>
            <td colspan="5" style="padding:0 10px;"><span class="fczl"></span></td>
        </tr>
        <tr>
            <td style="padding:0 10px;">承租人</td>
            <td colspan="5" style="padding:0 10px;"><span class="yf"></span></td>
        </tr>
        <tr>
            <td style="padding:0 10px;">合同面积（㎡）</td>
            <td style="padding:0 10px;"><span class="tbmjjz"></span></td>
            <td style="padding:0 10px;">合同单价（元/㎡/月）</td>
            <td style="padding:0 10px;"><span class="sjzj"></span></td>
            <td style="padding:0 10px;">开发区指导价（元/㎡/月）</td>
            <td style="padding:0 10px;"><span class="zdj"></span></td>
        </tr>
        <tr>
            <td style="padding:0 10px;">租赁期限(月)</td>
            <td colspan="3" style="padding:0 10px;"><span class="synx"></span></td>
            <td style="padding:0 10px;min-width: 80px;">新签<img src="images/choose01.svg" class="choose" id="new"></td>
            <td style="padding:0 10px;min-width: 80px;">续签<img src="images/choose01.svg" class="choose" id="old"></td>
        </tr>
        <tr>
            <td style="padding:0 10px;">免租期限</td>
            <td colspan="5" style="padding:0 10px;"><span class="mzq"></span></td>
        </tr>
        <tr>
            <td colspan="6" style="padding:0 10px;">优惠条款简要说明：<span class="yhtkjysm"></span></td>
        </tr>
        <tr>
            <td colspan="2" style="padding:0 10px;">管理中心经办人签字：</td>
            <td colspan="4" style="padding:0 10px;">负责人签字：<span class="qzDate" style="float: right;margin-right: 20px;"><span class=""
                                                                                                      style="margin: 0 20px;"></span>年<span
                    class="" style="margin: 0 20px;"></span>月<span class="" style="margin: 0 20px;"></span>日</span></td>
        </tr>
        <tr>
            <td colspan="6" style="padding:0 10px;">律师审核：<span class="qzDate" style="float: right;margin-right: 20px;"><span
                    class="" style="margin: 0 20px;"></span>年<span class="" style="margin: 0 20px;"></span>月<span class=""
                                                                                                                              style="margin: 0 20px;"></span>日</span>
            </td>
        </tr>
                
        <tr>
            <td colspan="6" style="padding:0 10px;">资产办审核：<span class="qzDate" style="float: right;margin-right: 20px;"><span
                    class="" style="margin: 0 20px;"></span>年<span class="" style="margin: 0 20px;"></span>月<span class=""
                                                                                                                              style="margin: 0 20px;"></span>日</span>
            </td>
        </tr>
        <tr>
            <td colspan="6" style="padding:0 10px;">财政审计局审核：<span class="qzDate" style="float: right;margin-right: 20px;"><span
                    class="" style="margin: 0 20px;"></span>年<span class="" style="margin: 0 20px;"></span>月<span class=""
                                                                                                                              style="margin: 0 20px;"></span>日</span>
            </td>
        </tr>
        <tr>
            <td colspan="6" style="padding:0 10px;">分管领导审核：<span class="qzDate" style="float: right;margin-right: 20px;"><span
                    class="" style="margin: 0 20px;"></span>年<span class="" style="margin: 0 20px;"></span>月<span class=""
                                                                                                                              style="margin: 0 20px;"></span>日</span>
            </td>
        </tr>
        <tr>
            <td colspan="6" style="padding:0 10px;">主要领导签批： <span class="qzDate" style="float: right;margin-right: 20px;"><span
                    class="" style="margin: 0 20px;"></span>年<span class="" style="margin: 0 20px;"></span>月<span class=""
                                                                                                                              style="margin: 0 20px;"></span>日</span>
            </td>
        </tr>
    </table>
</div>
<div class="printDiv" style="text-align: center;margin: 30px 0">
    <button id="btnPrintFull" style="width: 200px;z-index: 10000">打印</button>
</div>

<script src="public/js/jquery.js"></script>
<script src="public/js/public.js"></script>
<script src="public/js/jquery-1.4.4.min.js"></script>
<script src="public/js/jquery.jqprint-0.3.js"></script>
<script>
    $(function () {
        var heObj = JSON.parse(localStorage.getItem("heObj"));

        $("#btnPrintFull").click(function () {
            $("#htall").css("width","100%")
            $("#htall").jqprint();
        });

        var heObj = JSON.parse(localStorage.getItem("heObj"));
        $(".s-bbh").text(heObj.dealSerial)
        $(".yf").text(heObj.renter)
        $(".jf").text(heObj.lessor)
        $(".yf").text(heObj.renter)
        // $(".mjjz").text(heObj.resourceArea)
        // $(".syyt").text(heObj.houseUsage)
        $(".synx").text(heObj.startTime + "至" + heObj.endTime)
        $(".zlqx").text(heObj.rentMonth / 12)
        $(".starTime").text(heObj.startTime)
        $(".endTime").text(heObj.endTime)
        $(".yhtkjysm").text(heObj.discount)
        if (heObj.extraInfo == "") {
            $(".qtbz").text("无")
        } else {
            $(".qtbz").text(heObj.extraInfo)
        }

        // $(".sjzj").text(heObj.realRentCharge)
        if (heObj.payType == "以三个月为一周期支付") {
            $(".fkfs").text("3")
        } else if (heObj.payType == "以十二个月为一周期支付") {
            $(".fkfs").text("1")
        } else if (heObj.payType == "以六个月为一周期支付") {
            $(".fkfs").text("2")
        } else if (heObj.payType == "以一个月为周期支付") {
            $(".fkfs").text("4")
        }
        if (heObj.freeRentMonth == 0) {
            $(".freeZq").css("display", "none")
        } else {
            $(".mzq").text(heObj.startTime+"至"+heObj.freeEndTime)
        }

        // $(".bzj").text(heObj.deposit)
        // $(".sfxq").text()
        if (heObj.isNewRent == "新签") {
            $("#new").attr("src", "images/choose.svg")
            $("#old").attr("src", "images/choose01.svg")
        } else {
            $("#old").attr("src", "images/choose.svg")
            $("#new").attr("src", "images/choose01.svg")
        }
        $(".zdj").text(heObj.guideRentCharge)
        watermark({watermark_txt: heObj.dealSerial})//传入动态水印内容

        $(".ywyhtj").text(heObj.isHaveDiscount)

        $(heObj.mustMoney).each(function (i, o) {
            if (o.moneyType == "保证金") {
                $(".bzj").text(o.money)
            }
        })

        var zlArr = heObj.location.split(",")
        $("<span class='htSpan zl'></span><span>房屋(</span>建筑面积<span class='htSpan mjjz'></span>平方米)<span>,</span>租给乙方作<span class='htSpan syyt'></span>使用<span><span>,该房屋性质为非住宅。</span>").appendTo(".zlwz")

        if (heObj.houseResourceDetail.length < 2) {
            $(".tbmjjz").text(heObj.houseResourceDetail[0].resourceArea)
            $(".glzx").text(heObj.houseResourceDetail[0].agency)
            $(".mjjz").text(heObj.houseResourceDetail[0].resourceArea)
            $(".sjzj").text(heObj.houseResourceDetail[0].realRentCharge)
            $(".zdj").text(heObj.houseResourceDetail[0].guideRentCharge)
            $(".htsjzj").text(returnFloat(heObj.houseResourceDetail[0].realRentCharge * heObj.houseResourceDetail[0].resourceArea))
            $(".syyt").text(heObj.houseResourceDetail[0].resourceUsage)
            $(".fczl").text(heObj.houseResourceDetail[0].realLocation)
            $(".zl").text(heObj.houseResourceDetail[0].realLocation)
            // $(".mpfsjzj").text(heObj.houseResourceDetail[0].rentMoneyPerArea)
        } else {
            var glzxArr = []
            var tbAreaArr = []
            var heAreaArr = 0
            var djArr = []
            var zdjArr = []
            var yzjArr = []
            var realArr = []
            var yt = []
            var yzj = 0
            var dzArr = []
            $(heObj.houseResourceDetail).each(function (i, o) {
                glzxArr.push(o.agency)
                tbAreaArr.push(o.resourceArea)
                djArr.push(o.realRentCharge)
                zdjArr.push(o.guideRentCharge)
                yzjArr.push(o.originRentCharge)
                yt.push(o.resourceUsage)
                heAreaArr = heAreaArr + o.resourceArea
                yzj = yzj + o.realRentCharge * o.resourceArea
                dzArr.push(o.realLocation)
                // if (i > 0) {
                //     $("<span>;</span><span class='htSpan zl'>" + zlArr[i] + "</span><span>房屋(</span>建筑面积<span class='htSpan mjjz'>" + heObj.resourceArea + "</span>平方米<span>,</span>租给乙方作<span class='htSpan syyt'>" + o.houseUsage + "</span><span>使用</span><span>,</span><span class='htSpan mpfsjzj'>" + o.realRentCharge + "</span><span>元/m²/月</span><span>,该房屋性质为非住宅)</span>").appendTo(".zlwz")
                // } else {
                //     $("<span class='htSpan zl'>" + zlArr[i] + "</span><span>房屋(</span>建筑面积<span class='htSpan mjjz'>" + heObj.resourceArea + "</span>平方米<span>,</span>租给乙方作<span class='htSpan syyt'>" + o.houseUsage + "</span><span>使用</span><span>,</span><span class='htSpan mpfsjzj'>" + o.realRentCharge + "</span><span>元/m²/月</span><span>,该房屋性质为非住宅)</span>").appendTo(".zlwz")
                // }
            })

            var glzx = $.unique(glzxArr).join(";");
            $(".glzx").text(glzx)
            var tbArea = tbAreaArr.join(";");
            $(".tbmjjz").text(tbArea)
            $(".mjjz").text(heAreaArr)
            var dj = djArr.join(";");
            // $(".mpfsjzj").text(dj)
            $(".sjzj").text(dj)
            var zdj = zdjArr.join(";");
            $(".zdj").text(zdj)
            var sjzj = $.unique(yzjArr).join(";");
            $(".htsjzj").text(returnFloat(yzj))
            var oyt = $.unique(yt).join(";");
            $(".syyt").text(oyt)
            var dz = $.unique(dzArr).join(";");
            $(".fczl").text(dz)
            $(".zl").text(dz)
        }
    })

    function watermark(settings) {
        //默认设置
        var defaultSettings = {
            watermark_txt: "text",
            watermark_x: 0,//水印起始位置x轴坐标
            watermark_y: 140,//水印起始位置Y轴坐标
            watermark_rows: 1,//水印行数
            watermark_cols: 1,//水印列数
            watermark_x_space: 0,//水印x轴间隔
            watermark_y_space: 0,//水印y轴间隔
            watermark_color: '#bd1b21',//水印字体颜色
            watermark_alpha: 0.3,//水印透明度
            watermark_fontsize: '40px',//水印字体大小
            watermark_font: '微软雅黑',//水印字体
            watermark_width: 880,//水印宽度
            watermark_height: 96,//水印长度
            watermark_angle: 15,//水印倾斜度数
            watermark_padding: 70
        };
        //采用配置项替换默认值，作用类似jquery.extend
        if (arguments.length === 1 && typeof arguments[0] === "object") {
            var src = arguments[0] || {};
            for (key in src) {
                if (src[key] && defaultSettings[key] && src[key] === defaultSettings[key])
                    continue;
                else if (src[key])
                    defaultSettings[key] = src[key];
            }
        }

        var oTemp = document.createDocumentFragment();

        //获取页面最大宽度
        var page_width = window.innerWidth;
        //获取页面最大长度
        var page_height = $("body").height();

        //如果将水印列数设置为0，或水印列数设置过大，超过页面最大宽度，则重新计算水印列数和水印x轴间隔
        if (defaultSettings.watermark_cols == 0 ||
            (parseInt(defaultSettings.watermark_x
                + defaultSettings.watermark_width * defaultSettings.watermark_cols
                + defaultSettings.watermark_x_space * (defaultSettings.watermark_cols - 1))
                > page_width)) {
            defaultSettings.watermark_cols =
                parseInt((page_width
                    - defaultSettings.watermark_x
                    + defaultSettings.watermark_x_space)
                    / (defaultSettings.watermark_width
                        + defaultSettings.watermark_x_space));
            defaultSettings.watermark_x_space =
                parseInt((page_width
                    - defaultSettings.watermark_x
                    - defaultSettings.watermark_width
                    * defaultSettings.watermark_cols)
                    / (defaultSettings.watermark_cols - 1));
        }
        //如果将水印行数设置为0，或水印行数设置过大，超过页面最大长度，则重新计算水印行数和水印y轴间隔
        if (defaultSettings.watermark_rows == 0 ||
            (parseInt(defaultSettings.watermark_y
                + defaultSettings.watermark_height * defaultSettings.watermark_rows
                + defaultSettings.watermark_y_space * (defaultSettings.watermark_rows - 1))
                > page_height)) {
            defaultSettings.watermark_rows =
                parseInt((defaultSettings.watermark_y_space
                    + page_height - defaultSettings.watermark_y)
                    / (defaultSettings.watermark_height + defaultSettings.watermark_y_space));
            defaultSettings.watermark_y_space =
                parseInt((page_height
                    - defaultSettings.watermark_y
                    - defaultSettings.watermark_height
                    * defaultSettings.watermark_rows)
                    / (defaultSettings.watermark_rows - 1));
        }
        var x;
        var y;
        for (var i = 0; i < defaultSettings.watermark_rows; i++) {
            y = defaultSettings.watermark_y + (defaultSettings.watermark_y_space + defaultSettings.watermark_height) * i;
            for (var j = 0; j < defaultSettings.watermark_cols; j++) {
                x = defaultSettings.watermark_x + (defaultSettings.watermark_width + defaultSettings.watermark_x_space) * j;

                var mask_div = document.createElement('div');
                mask_div.id = 'mask_div' + i + j;
                mask_div.appendChild(document.createTextNode(defaultSettings.watermark_txt));
                //设置水印div倾斜显示
                mask_div.style.webkitTransform = "rotate(-" + defaultSettings.watermark_angle + "deg)";
                mask_div.style.MozTransform = "rotate(-" + defaultSettings.watermark_angle + "deg)";
                mask_div.style.msTransform = "rotate(-" + defaultSettings.watermark_angle + "deg)";
                mask_div.style.OTransform = "rotate(-" + defaultSettings.watermark_angle + "deg)";
                mask_div.style.transform = "rotate(-" + defaultSettings.watermark_angle + "deg)";
                mask_div.style.visibility = "";
                mask_div.style.position = "absolute";
                mask_div.style.left = x + 'px';
                mask_div.style.top = y + 'px';
                mask_div.style.overflow = "hidden";
                mask_div.style.zIndex = "9999";
                //mask_div.style.border="solid #eee 1px";
                mask_div.style.opacity = defaultSettings.watermark_alpha;
                mask_div.style.fontSize = defaultSettings.watermark_fontsize;
                mask_div.style.fontFamily = defaultSettings.watermark_font;
                mask_div.style.color = defaultSettings.watermark_color;
                mask_div.style.textAlign = "center";
                mask_div.style.width = defaultSettings.watermark_width + 'px';
                mask_div.style.height = defaultSettings.watermark_height + 'px';
                mask_div.style.display = "block";
                mask_div.style.paddingTop = "70px";
                oTemp.appendChild(mask_div);
            }
            ;
        }
        ;
        $(oTemp).appendTo("#htall")
    }
    function returnFloat(value) {
        var value = Math.round(parseFloat(value) * 100) / 100;
        var xsd = value.toString().split(".");
        if (xsd.length == 1) {
            value = value.toString() + ".00";
            return value;
        }
        if (xsd.length > 1) {
            if (xsd[1].length < 2) {
                value = value.toString() + "0";
            }
            return value;
        }
    }
</script>
</body>
</html>